# dnsmasq.conf for PXE proxy setup
# Router/DHCP server still gives out IPs. dnsmasq only answers PXE boot requests.

# Basic behavior
port=0                          # disable DNS service
log-dhcp                        # basic DHCP logging
log-facility=/var/log/dnsmasq-pxe.log

# Bind only to the PXE-facing interface to avoid interfering with router DHCP
interface=eth0                  # <--- set to the interface attached to the PXE network
bind-interfaces

# ProxyDHCP: do not allocate IPs, just provide PXE options for the given subnet
# Use the network id (not router IP nor DHCP pool)
dhcp-range=192.168.50.0,proxy
dhcp-no-override

# Provide PXE boot info only for matching clients (prevent accidental advertising)
# Example per-MAC fixed-address + hostname (lowercase mac recommended)
# Format: dhcp-host=<mac>,<ip>,<hostname>,<lease>
dhcp-host=DC:A6:32:44:BC:F5,192.168.50.91,max-sports-analysis-pi,12h

# Advertise PXE boot options for x86 BIOS + UEFI
pxe-service=x86PC, "PXELINUX (BIOS)", pxelinux/pxelinux.0
pxe-service=X86-64_EFI, "PXE UEFI iPXE", ipxe.efi

# TFTP server settings
enable-tftp
tftp-root=/srv/tftpboot       # ensure proper perms and chrooting
tftp-no-fork                      # optional: run in foreground for better logging
secure-tftp