---
- name: Unlock and mount encrypted USB
  block:
    - name: Open LUKS device
      command: >
        cryptsetup luksOpen /dev/disk/by-uuid/0c0c73a8-79f9-4554-b241-27636c5d6a9d intermediate_ca
      args:
        stdin: "{{ intermediate_ca_passphrase }}"
      become: true

    - name: Mount unlocked volume
      ansible.posix.mount:
        path: /mnt/intermediate_ca
        src: /dev/mapper/intermediate_ca
        fstype: ext4
        state: mounted